<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sua Opini√£o - Cine Max BR</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@500;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <style>
        /* CSS (Mantendo o Design Bonito) */
        :root {
            --primary-color: #6a11cb;
            --secondary-color: #2575fc;
            --text-light: #e0e0e0;
            --card-bg: #2d2d44;
            --border-color: #4a4a6b;
            --success-color: #28a745;
            --danger-color: #dc3545;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: var(--text-light);
        }

        .container {
            width: 90%;
            max-width: 600px;
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        h1 { font-family: 'Oswald', sans-serif; font-size: 3em; margin-bottom: 10px; text-transform: uppercase; }
        h2 { font-family: 'Poppins', sans-serif; font-weight: 300; font-size: 1.2em; margin-bottom: 40px; color: var(--text-light); opacity: 0.8; }
        .feedback-options { display: flex; justify-content: center; gap: 20px; margin-bottom: 40px; }
        .feedback-btn { background-color: transparent; border: 2px solid var(--border-color); color: var(--text-light); font-size: 3em; width: 120px; height: 120px; border-radius: 50%; cursor: pointer; transition: all 0.3s ease; display: flex; justify-content: center; align-items: center; }
        .feedback-btn:hover { transform: scale(1.1); border-color: var(--secondary-color); }
        .feedback-btn.selected { transform: scale(1.1); }
        .feedback-btn.like.selected { background-color: var(--success-color); border-color: var(--success-color); }
        .feedback-btn.dislike.selected { background-color: var(--danger-color); border-color: var(--danger-color); }
        .comment-section { margin-bottom: 30px; }
        textarea { width: 100%; height: 120px; background-color: #1a1a2e; border: 2px solid var(--border-color); border-radius: 10px; padding: 15px; color: var(--text-light); font-family: 'Poppins', sans-serif; font-size: 1em; resize: vertical; }
        textarea:focus { outline: none; border-color: var(--secondary-color); }
        .submit-btn { background: linear-gradient(to right, var(--primary-color), var(--secondary-color)); color: white; border: none; padding: 15px 40px; font-size: 1.2em; font-weight: 600; border-radius: 50px; cursor: pointer; transition: all 0.3s ease; margin-bottom: 30px; }
        .submit-btn:hover { transform: scale(1.05); box-shadow: 0 5px 15px rgba(40, 116, 252, 0.4); }
        .back-link { color: var(--text-light); opacity: 0.7; text-decoration: none; transition: opacity 0.2s; }
        .back-link:hover { opacity: 1; }
    </style>
</head>
<body>

    <form action="https://formspree.io/f/xeorpzde" method="POST" id="feedbackForm">
        <div class="container">
            <h1>Deixe sua Opini√£o</h1>
            <h2>Para ser direcionado ao link do filme, por favor, avalie nossa p√°gina!</h2>

            <div class="feedback-options">
                <button type="button" class="feedback-btn like" id="likeBtn">
                    <i class="fa-solid fa-thumbs-up"></i>
                </button>
                <button type="button" class="feedback-btn dislike" id="dislikeBtn">
                    <i class="fa-solid fa-thumbs-down"></i>
                </button>
            </div>

            <input type="hidden" name="avaliacao_e_filme" id="avaliacaoInput">
            <input type="hidden" name="destino_final_url" id="destinoFinalUrl">
            
            <div class="comment-section">
                <textarea name="comentario" id="commentBox" placeholder="Escreva seu coment√°rio aqui..."></textarea>
            </div>

            <button type="submit" class="submit-btn">Enviar e Assistir!</button>

            <p><a href="index.html" class="back-link">Voltar para a p√°gina inicial</a></p>
        </div>
    </form>

    <script>
        // Mapa de links de destino (Google Drive) - ATUALIZADO COM SEUS LINKS
        const DESTINO_URLS = {
            // SUBSTITUA ESTE BLOCO NO SEU feedback.html
const DESTINO_URLS = {
    // Redireciona para o player.html, passando o ID do filme
    'filme1': 'player.html?id=filme1', 
    'filme2': 'player.html?id=filme2',
    'filme3': 'player.html?id=filme3',
    'filme4': 'player.html?id=filme4'
        }

        // 1. CAPTURA QUAL FILME O USU√ÅRIO QUER VER
        const urlParams = new URLSearchParams(window.location.search);
        const destinoParam = urlParams.get('destino');
        
        // 2. PREPARA O FORMUL√ÅRIO
        const likeBtn = document.getElementById('likeBtn');
        const dislikeBtn = document.getElementById('dislikeBtn');
        const avaliacaoInput = document.getElementById('avaliacaoInput');
        const destinoFinalUrl = document.getElementById('destinoFinalUrl');
        const form = document.getElementById('feedbackForm');

        // Preenche o campo oculto com a URL real de destino
        if (destinoParam && DESTINO_URLS[destinoParam]) {
            destinoFinalUrl.value = DESTINO_URLS[destinoParam];
        }

        // 3. ATUALIZA A L√ìGICA DE CLIQUE
        function atualizarAvaliacao(tipo) {
            const filmeNome = destinoParam === 'filme1' ? 'Bumblebee' :
                              destinoParam === 'filme2' ? 'Velozes & Furiosos' :
                              destinoParam === 'filme3' ? 'Max Steel' : 'P√°gina';
            avaliacaoInput.value = `${tipo} - Filme: ${filmeNome}`;
        }

        likeBtn.addEventListener('click', () => {
            likeBtn.classList.add('selected');
            dislikeBtn.classList.remove('selected');
            atualizarAvaliacao('Gostei');
        });

        dislikeBtn.addEventListener('click', () => {
            dislikeBtn.classList.add('selected');
            likeBtn.classList.remove('selected');
            atualizarAvaliacao('N√£o Gostei');
        });

        // 4. L√ìGICA DE REDIRECIONAMENTO IMEDIATO AP√ìS O ENVIO (AJAX/Fetch)
        form.addEventListener('submit', async function(e) {
            e.preventDefault(); // Impede o envio padr√£o para que possamos enviar via JS

            if (!avaliacaoInput.value) {
                alert('Por favor, selecione uma das op√ß√µes (üëç ou üëé) antes de enviar.');
                return;
            }

            const formData = new FormData(form);
            const formURL = form.getAttribute('action');
            const linkFilme = destinoFinalUrl.value;
            
            // 1. Envia o Feedback (em segundo plano)
            try {
                // Tenta enviar o formul√°rio para o Formspree
                const response = await fetch(formURL, {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'Accept': 'application/json'
                    }
                });
                
                // Verifica se a requisi√ß√£o foi bem-sucedida (status 200 a 299)
                if (response.ok) {
                    alert("Obrigado pelo seu feedback! Redirecionando para o seu filme...");
                    // 2. Redireciona o usu√°rio para o Google Drive
                    window.location.href = linkFilme; 
                } else {
                    // Se o Formspree retornou um erro (ex: problema de limite), ainda redireciona
                    alert("Erro ao salvar o feedback, mas voc√™ ser√° redirecionado para o filme.");
                    window.location.href = linkFilme;
                }

            } catch (error) {
                // Em caso de falha de rede/conex√£o, ainda redireciona o usu√°rio
                console.error('Falha na conex√£o ao enviar feedback:', error);
                alert("Erro de conex√£o ao salvar o feedback. Redirecionando para o filme.");
                window.location.href = linkFilme; 
            }
        });
    </script>

</body>
</html>
